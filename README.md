# Telegram-бот для анализа статистики видео

## Обзор
Этот Telegram-бот позволяет пользователям делать запросы к статистике видео из базы данных PostgreSQL с использованием естественного русского языка. Бот преобразует текстовые запросы в SQL-запросы и возвращает числовые результаты.
Для обработки естественного языка используется DeepSeek API (работает в РФ) с резервным локальным парсером на основе правил.

## Архитектура
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│   Telegram      │────▶│   Bot (Python)  │────▶│   PostgreSQL    │
│   User          │     │   aiogram +     │     │   Database      │
│                 │◀────│   DeepSeek API  │◀────│   (videos +     │
└─────────────────┘     └─────────────────┘     │    snapshots)   │
                                                └─────────────────┘

## Обработка естественного языка
Подход
Бот использует двухуровневую систему обработки запросов:
DeepSeek API (основной) — преобразует текст в SQL с помощью LLM
Локальный парсер (резервный) — обрабатывает запросы по правилам, если API недоступен


## Запуск
1. Создайте файл `.env` (см. `.env_example`).
2. Положите файл `videos.json` в корень проекта.
3. Выполните команду:
   ```bash
   docker-compose up --build

## Архитектура
- **База данных:** PostgreSQL с двумя таблицами:
  - `videos`: Хранит итоговую статистику для каждого видео
  - `video_snapshots`: Хранит почасовые снимки показателей видео
- **Backend:** Python-приложение с использованием асинхронных библиотек (aiogram, asyncpg)
- **Интеграция LLM:** Обработка естественного языка для преобразования запросов в SQL
- **Docker Compose:** Для удобного локального развертывания

## Используемые технологии
- Python 3.9+
- aiogram (асинхронный фреймворк Telegram-ботов)
- asyncpg (асинхронный драйвер PostgreSQL)
- DeepSeek API для NLP
- Docker & Docker Compose

### Предварительные требования
- Установленные Docker и Docker Compose
- Токен Telegram-бота (получить у @BotFather)


